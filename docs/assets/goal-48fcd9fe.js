var J=Object.defineProperty;var X=(r,t,e)=>t in r?J(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var o=(r,t,e)=>(X(r,typeof t!="symbol"?t+"":t,e),e);import"./style-980df246.js";import{R as E,C as A,M as Z,P as tt}from"./progressbar.component-7bf41c26.js";import{T as Y,A as p,O as d,D as $,I as B}from"./target-type-selection.component-3c9280ae.js";var c=(r=>(r[r.TASK=0]="TASK",r[r.COLLECT_MONEY=1]="COLLECT_MONEY",r[r.REACH_TARGET_1B1=2]="REACH_TARGET_1B1",r))(c||{});function M(r){if(r.children.length===0){if(r.targetType===0)return r.calculatedProgress=+r.done;if(r.targetType===2||r.targetType===1){let t=r;return t.calculatedProgress=t.extraData.currentAmount/t.extraData.targetAmount}throw new Error("Unknown target type")}else{let t=0;return r.children.forEach(e=>{t+=M(e)}),r.calculatedProgress=t/r.children.length}}var et=Object.defineProperty,nt=Object.getOwnPropertyDescriptor,at=(r,t,e,n)=>{for(var a=n>1?void 0:n?nt(t,e):t,s=r.length-1,i;s>=0;s--)(i=r[s])&&(a=(n?i(t,e,a):i(a))||a);return n&&a&&et(t,e,a),a};let I=class extends A{constructor(){super(...arguments);o(this,"content");o(this,"leftHalf");o(this,"rightHalf");o(this,"progress_",0)}async onInit(){this.content=document.createElement("div"),this.content.innerHTML=`
<img src="/achive-it/icons/check-small.svg" alt="" width="16" height="16">
<div class="checkbox-container">
    <div style="z-index: 1">
        <div class="checkbox-part clipped">
            <div class="checkbox-circle">
                <div class="circle-half">
                    <div></div>
                </div>
                <div class="circle-half circle-half-right">
                    <div></div>
                </div>
            </div>
        </div>
    </div>
    <div>
        <div class="checkbox-part">
            <div class="checkbox-circle">
                <div class="circle-half">
                    <div></div>
                </div>
                <div class="circle-half circle-half-right">
                    <div></div>
                </div>
            </div>
        </div>
    </div>
    <div class="background-checkbox"></div>
</div>
`,this.append(this.content),this.leftHalf=this.querySelectorAll(".circle-half> div"),this.rightHalf=this.querySelectorAll(".circle-half-right> div"),this.progress=this.progress_}get progress(){return this.progress_}set progress(t){if(t>1&&(t%=1),this.progress_=t,!this.leftHalf||!this.rightHalf)return;let e=180-Math.min(t*2,1)*180;this.leftHalf.forEach(a=>{a.style.transform=`rotate(${Math.round(e)}deg)`});let n=180-Math.max(t*2-1,0)*180;this.rightHalf.forEach(a=>{a.style.transform=`rotate(${Math.round(n)}deg)`}),t===1?this.classList.add("done"):this.classList.remove("done")}};I=at([E({name:"my-checkbox"})],I);var it=Object.defineProperty,rt=Object.getOwnPropertyDescriptor,st=(r,t,e,n)=>{for(var a=n>1?void 0:n?rt(t,e):t,s=r.length-1,i;s>=0;s--)(i=r[s])&&(a=(n?i(t,e,a):i(a))||a);return n&&a&&it(t,e,a),a};let k=class extends A{};k=st([E({name:"action-list"})],k);var lt=Object.defineProperty,ct=Object.getOwnPropertyDescriptor,ot=(r,t,e,n)=>{for(var a=n>1?void 0:n?ct(t,e):t,s=r.length-1,i;s>=0;s--)(i=r[s])&&(a=(n?i(t,e,a):i(a))||a);return n&&a&&lt(t,e,a),a};const W=4;let f=class extends A{constructor(t={},e){super();o(this,"input");o(this,"hiddenSpan");o(this,"minWidth",20);o(this,"_value","");o(this,"config",{inputType:"number"});this.observable=e,Object.assign(this.config,t),e&&e.subscribe(n=>{this.value!=n&&(this._value=n,this.value=n)})}async onInit(){this.input=document.createElement("input"),this.input.type=this.config.inputType,this.value=this._value,this.config.min&&(this.input.min=this.config.min),this.config.max&&(this.input.max=this.config.max),this.config.placeholder&&(this.input.placeholder=this.config.placeholder),this.append(this.input),this.hiddenSpan=document.createElement("span"),this.hiddenSpan.classList.add("hidden-span"),this.append(this.hiddenSpan),this.input.addEventListener("keyup",t=>{var e;this.isValidValue(((e=this.input)==null?void 0:e.value)??"")||(t.preventDefault(),this.value=this._value)}),this.input.addEventListener("input",()=>{var t;this.resize(),this.isValidValue(this.value)&&(this._value=this.value,this.observable&&(this.observable.value=((t=this.input)==null?void 0:t.value)??""))}),this.resize()}resize(){if(!this.input||!this.hiddenSpan)return;this.hiddenSpan.innerText=this.input.value;let t=this.hiddenSpan.offsetWidth+W*2;this.hiddenSpan.innerText=this.config.placeholder??"";let e=this.hiddenSpan.offsetWidth+W*2;String(this.value).length!==0&&(e=0),this.input.style.width=Math.max(t,e,this.minWidth)+"px"}get value(){var t;return(t=this.input)==null?void 0:t.value}isValidValue(t){return!(!this.input||this.config.max&&+t>+this.config.max)}set value(t){this.isValidValue(t??"")&&(this._value=t??"",this.input&&(this.input.value=this._value,this.resize()))}set max(t){this.input&&(this.input.max=t)}set min(t){this.input&&(this.input.min=t)}};f=ot([E({name:"control-input"})],f);var dt=Object.defineProperty,ht=Object.getOwnPropertyDescriptor,ut=(r,t,e,n)=>{for(var a=n>1?void 0:n?ht(t,e):t,s=r.length-1,i;s>=0;s--)(i=r[s])&&(a=(n?i(t,e,a):i(a))||a);return n&&a&&dt(t,e,a),a};let R=class extends A{constructor(t){super();o(this,"targetTypeSelection");this.isRootTarget=t}async onInit(){const t=document.createElement("img");t.tabIndex=0,t.src="/achive-it/add-left.png",t.alt="Add target one level up",t.title="Add target one level up",t.width=50,t.height=26,this.isRootTarget&&(t.style.visibility="hidden"),t.addEventListener("click",()=>{this.showTargetTypeSelection()}),t.addEventListener("focusout",()=>this.hideTargetTypeSelection());const e=document.createElement("img");e.tabIndex=0,e.src="/achive-it/add-below.png",e.alt="Add target at the same depth",e.title="Add target at the same depth",e.width=50,e.height=26,e.addEventListener("click",()=>{this.showTargetTypeSelection()}),e.addEventListener("focusout",()=>this.hideTargetTypeSelection());const n=document.createElement("img");n.tabIndex=0,n.src="/achive-it/add-right.png",n.alt="Add child target",n.title="Add child target",n.width=50,n.height=26,n.addEventListener("click",()=>{this.showTargetTypeSelection()}),n.addEventListener("focusout",()=>this.hideTargetTypeSelection());let a=document.createElement("div");a.append(t),a.append(e),a.append(n);let s=document.createElement("div");s.classList.add("tts-cont"),this.targetTypeSelection=new Y,s.append(this.targetTypeSelection),this.append(s),this.append(a)}showTargetTypeSelection(){this.targetTypeSelection&&(this.targetTypeSelection.style.display="block")}hideTargetTypeSelection(){this.targetTypeSelection&&(this.targetTypeSelection.style.display="none")}};R=ut([E({name:"target-button-container"})],R);var pt=Object.defineProperty,gt=Object.getOwnPropertyDescriptor,mt=(r,t,e,n)=>{for(var a=n>1?void 0:n?gt(t,e):t,s=r.length-1,i;s>=0;s--)(i=r[s])&&(a=(n?i(t,e,a):i(a))||a);return n&&a&&pt(t,e,a),a};let T=class extends A{constructor(t){super();o(this,"target_");o(this,"checkbox");o(this,"rowContainer");o(this,"childrenContainer");o(this,"contentContainer");o(this,"titleInput");o(this,"maxAmountEl");o(this,"currentAmountEl");o(this,"$targetAmount");o(this,"$currentAmount");this.target_=t}recalculate(){var t;M(this.target_),this.checkbox&&(this.checkbox.progress=this.target_.calculatedProgress),(t=this.parentTargetElement)==null||t.recalculate(),F()}finishTarget(){switch(this.target_.done=!0,this.target_.calculatedProgress=1,this.checkbox&&(this.checkbox.progress=1),this.target_.targetType){case c.COLLECT_MONEY:case c.REACH_TARGET_1B1:this.target_.extraData.currentAmount=this.target_.extraData.targetAmount,this.$currentAmount.value=this.target_.extraData.currentAmount;break}if(this.recalculate(),!!this.childrenContainer)for(let t=0;t<this.childrenContainer.children.length;t++)this.childrenContainer.children.item(t).finishTarget()}unfinishTarget(){switch(this.target_.done=!1,this.target_.calculatedProgress=0,this.checkbox&&(this.checkbox.progress=0),this.target_.targetType){case c.COLLECT_MONEY:case c.REACH_TARGET_1B1:this.target_.extraData.currentAmount=0,this.$currentAmount.value=this.target_.extraData.currentAmount;break}if(this.recalculate(),!!this.childrenContainer)for(let t=0;t<this.childrenContainer.children.length;t++)this.childrenContainer.children.item(t).unfinishTarget()}async onInit(){this.rowContainer=this.createRowContainer(),this.append(this.rowContainer),this.childrenContainer=this.createChildrenContainer(),this.append(this.childrenContainer)}initCheckbox(){let t=new I;return t.progress=this.target_.calculatedProgress,t.addEventListener("click",()=>{this.target_.done?(this.unfinishTarget(),console.log("unfinish")):(this.finishTarget(),console.log("finish"))}),t}createRowContainer(){const t=document.createElement("div");t.classList.add("row-container");let e=document.createElement("div");e.classList.add("background-element"),t.append(e);let n=document.createElement("div");n.classList.add("good-place-row"),e.append(n);let a=document.createElement("div");a.classList.add("target-header"),n.append(a),this.contentContainer=this.createContentContainer(),n.append(this.contentContainer);let s=document.createElement("div");s.classList.add("target-checkbox"),a.append(s),this.checkbox=this.initCheckbox(),s.append(this.checkbox),this.titleInput=this.createTitleInput(),a.append(this.titleInput),a.append(this.createTargetSpecificInputs());let i=this.createActionList();n.append(i);const u=new R(!1);return n.append(u),t}get parentTargetElement(){var e;let t=(e=this.parentElement)==null?void 0:e.parentElement;return t instanceof T?t:null}createActionList(){let t=new k,e=this;const n=new p("Delete target","delete",()=>{let i=e.parentTargetElement;if(this.outerHTML="",!i){_t(e.target_);return}let u=i.target_;u.children=i.target_.children.filter(g=>g!=this.target_),i.recalculate()});t.append(n);const a=new p("Add date","date",()=>{if(this.target_.date)return;this.target_.date="";let i=new d(this.target_.date);this.contentContainer.append(new $(i))});t.append(a);const s=new p("Add details","add-description",()=>{if(this.target_.details)return;this.target_.details="Write something S.M.A.R.T...";let i=this.createDetails();this.contentContainer.prepend(i)});return t.append(s),t}createContentContainer(){const t=document.createElement("div");if(t.classList.add("target-content"),this.target_.details){let e=this.createDetails();t.append(e)}if(this.target_.date){let e=new d(this.target_.date);t.append(new $(e))}return t}createDetails(){let t=document.createElement("div");t.classList.add("target-details");let e=document.createElement("img");e.src="/achive-it/icons/description-black.svg",t.append(e);let n=document.createElement("span");return n.contentEditable="true",n.innerText=this.target_.details,new MutationObserver(()=>{this.target_.details=n.innerText}).observe(n,{attributes:!1,childList:!0}),t.append(n),t}createChildrenContainer(){const t=document.createElement("div");return t.classList.add("child-list"),this.target_.children.forEach(e=>{let n=new T(e);t.append(n)}),t}createTitleInput(){const t=document.createElement("input");return t.classList.add("title-input"),t.value=this.target_.title,t.placeholder="Target title",t}createTargetSpecificInputs(){let t=document.createElement("div");switch(t.classList.add("target-type-container"),this.target_.targetType){case c.COLLECT_MONEY:this.initCollectMoneyInputs(t);break;case c.REACH_TARGET_1B1:this.initReachTarget1B1Inputs(t);break}return t}initCollectMoneyInputs(t){t.classList.add("control-money");const e=this.$currentAmount=new d(this.target_.extraData.currentAmount,(l,P)=>l>=0&&l<=this.target_.extraData.targetAmount&&l!==P),n=this.$targetAmount=new d(this.target_.extraData.targetAmount,(l,P)=>l!==P);e.subscribe(l=>{this.target_.extraData.currentAmount=l,this.target_.done=l>=this.target_.extraData.targetAmount,this.recalculate()}),n.subscribe(l=>{this.target_.extraData.targetAmount=l,l<e.value&&(e.value=l),this.recalculate()});const a=d.map(e,l=>String(l),l=>Number(l));let s=new p("Add amount","add-amount",()=>{i.value&&(e.value=Math.max(0,Math.min(n.value,Number(+e.value+ +i.value))),i.value="")}),i=new d(""),u=new f({placeholder:"+ Add Amount"},i);this.currentAmountEl=new f({min:"0",max:n.value.toString()},a),n.subscribe(l=>this.currentAmountEl.max=l.toString()),t.append(u),t.append(s),t.append(this.currentAmountEl);let g=document.createElement("span");g.classList.add("target-amount-span"),g.title=`Target amount   
(click to change)`,n.subscribe(l=>{g.innerText=`/ EUR ${l}`}),g.addEventListener("click",()=>{let l=prompt("New target:",n.value.toString());l&&(n.value=Number(l))}),t.append(g)}initReachTarget1B1Inputs(t){t.classList.add("control-1b1-cont");const e=this.$currentAmount=new d(this.target_.extraData.currentAmount,(i,u)=>i>=0&&i<=this.target_.extraData.targetAmount&&i!==u),n=this.$targetAmount=new d(this.target_.extraData.targetAmount,(i,u)=>i>0&&i!==u);e.subscribe(i=>{this.target_.extraData.currentAmount=i,this.target_.done=i>=this.target_.extraData.targetAmount,this.recalculate()}),n.subscribe(i=>{this.target_.extraData.targetAmount=i,i<e.value&&(e.value=i),this.recalculate()});const a=d.map(e,i=>String(i),i=>Number(i));t.append(new p("Decrement current value","minus",()=>e.value--)),t.append(new p("Increment current value","plus",()=>e.value++)),this.currentAmountEl=new f({min:"0",max:n.value.toString()},a),n.subscribe(i=>this.currentAmountEl.max=i.toString()),t.append(this.currentAmountEl);let s=document.createElement("span");s.classList.add("target-amount-span"),s.title=`Target amount   
(click to change)`,n.subscribe(i=>{s.innerText=`/ ${i}`}),s.addEventListener("click",()=>{let i=prompt("New target:",n.value.toString());i&&(n.value=Number(i))}),t.append(s)}set maxAmount(t){if(t!==void 0)switch(this.target_.targetType){case c.REACH_TARGET_1B1:if(!this.maxAmountEl)return;this.maxAmountEl.innerText="/ "+t.toString();break;case c.COLLECT_MONEY:break}}get maxAmount(){return this.target_.extraData.targetAmount}};T=mt([E({name:"my-target"})],T);const m=document.querySelector(".app-layout");let vt=new Z({name:"My Goals",url:"/achive-it/dashboard.html"});m.appendChild(vt);const C=document.createElement("input");C.classList.add("goal-title");C.value="Become a better person";C.placeholder="Goal title";m.appendChild(C);let _=new tt;_.style.marginBottom="10px";m.appendChild(_);const y=document.createElement("div");y.classList.add("goal-buttons");m.append(y);const x=document.createElement("div");y.append(x);const H=document.createElement("div");H.classList.add("goal-additional-data-container");m.append(H);const ft=new d(""),w=new $(ft);w.style.gap="3px";w.style.display="none";x.append(w);let v=document.createElement("div");v.classList.add("details-row");v.style.display="none";H.append(v);const z=document.createElement("img");z.src="/achive-it/icons/description-black.svg";v.append(z);const L=document.createElement("div");L.contentEditable="true";L.style.width="100%";L.innerText="Write something S.M.A.R.T...";v.append(L);const V=new p("Add date","date-black",()=>{w.style.display="flex",V.style.display="none"}),U=new p("Add details","add-description",()=>{v.style.display="flex",U.style.display="none"});x.append(V);x.append(U);let N=document.createElement("div");y.appendChild(N);let S=new B("/achive-it/icons/tick-circle.svg","MARK COMPLETED");S.classList.add("icon-button-green");N.appendChild(S);let G=new B("/achive-it/icons/very-dissatisfied-circle.svg","CANCEL GOAL");G.classList.add("icon-button-red");G.addEventListener("click",()=>{confirm("Are you sure you want to cancel the goal?")&&(window.location.href="/achive-it/dashboard.html")});N.appendChild(G);let Tt=[{title:"Cut the grass",children:[],done:!1,targetType:c.TASK},{title:"Chop up the potatoes",children:[],done:!1,targetType:c.REACH_TARGET_1B1,extraData:{targetAmount:10,currentAmount:3}},{title:"Save money to pay the bills",children:[],done:!1,targetType:c.COLLECT_MONEY,extraData:{targetAmount:110,currentAmount:95}},{title:"Do the dishes",done:!1,targetType:c.TASK,children:[{title:"Put the dry dishes in the cabinet",done:!1,targetType:c.TASK,children:[]},{title:"Put the dirty dishes in the dishwasher except the knifes",done:!0,children:[],targetType:c.TASK},{title:"Start the dishwasher",done:!1,children:[],targetType:c.TASK,date:"2023-12-23"},{title:"Chop up the potatoes",children:[],done:!1,targetType:c.REACH_TARGET_1B1,extraData:{targetAmount:8,currentAmount:6}},{title:"Wash the remanining dishes by hand",done:!1,children:[{title:"Clean the toilet",done:!1,children:[],targetType:c.TASK},{title:"Clean the sink",done:!0,children:[],targetType:c.TASK}],targetType:c.TASK,date:"2023-12-23",details:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Quisque vehicula quam at purus congue, ut pretium felis mattis. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Donec in magna aliquam, sagittis ex eget, laoreet neque. Donec volutpat elit sagittis ligula faucibus, et luctus augue interdum."}]},{title:"Clean the bathroom",done:!0,targetType:c.TASK,children:[{title:"Clean the toilet",done:!0,children:[],targetType:c.TASK},{title:"Clean the sink",done:!0,children:[],targetType:c.TASK}]}],h=new d(Tt);h.subscribe(()=>F());function F(){let r=0;if(h.value.length==0){_.setAttribute("rate","0");return}h.value.forEach(t=>{r+=t.calculatedProgress}),r/=h.value.length,_.setAttribute("rate",r.toString())}let K=document.createElement("div");K.classList.add("target-list");let D=0;h.value.forEach(r=>D+=M(r));h.value.length>0&&(D/=h.value.length);console.log(D);_.setAttribute("rate",D.toString());const Q=new Array;for(let r of h.value){let t=new T(r);K.append(t),Q.push(t)}S.addEventListener("click",()=>{Q.forEach(r=>{r.finishTarget()})});h.subscribe(r=>S.style.display=r.length==0?"none":"flex");m.appendChild(K);function _t(r){h.value=h.value.filter(t=>t!==r)}const j=document.createElement("div");j.classList.add("add-target");m.appendChild(j);const b=new B("/icons/plus.svg","Add Target");b.classList.add("add-target-btn");b.addEventListener("click",()=>O.style.display="flex");b.addEventListener("focusout",()=>O.style.display="none");j.appendChild(b);let q=document.createElement("div");q.classList.add("tts-cont");let O=new Y;O.style.display="none";q.append(O);b.append(q);
