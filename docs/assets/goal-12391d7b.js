var Y=Object.defineProperty;var z=(r,t,e)=>t in r?Y(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var o=(r,t,e)=>(z(r,typeof t!="symbol"?t+"":t,e),e);import"./style-9f216c18.js";import{R as A,C,M as V,P as U}from"./progressbar.component-7bf41c26.js";import{T as K,A as m,O as d,D as L,I as P}from"./target-type-selection.component-43b1fd9f.js";var c=(r=>(r[r.TASK=0]="TASK",r[r.COLLECT_MONEY=1]="COLLECT_MONEY",r[r.REACH_TARGET_1B1=2]="REACH_TARGET_1B1",r))(c||{});function $(r){if(r.children.length===0){if(r.targetType===0)return r.calculatedProgress=+r.done;if(r.targetType===2||r.targetType===1){let t=r;return t.calculatedProgress=t.extraData.currentAmount/t.extraData.targetAmount}throw new Error("Unknown target type")}else{let t=0;return r.children.forEach(e=>{t+=$(e)}),r.calculatedProgress=t/r.children.length}}var Q=Object.defineProperty,F=Object.getOwnPropertyDescriptor,J=(r,t,e,n)=>{for(var i=n>1?void 0:n?F(t,e):t,s=r.length-1,a;s>=0;s--)(a=r[s])&&(i=(n?a(t,e,i):a(i))||i);return n&&i&&Q(t,e,i),i};let S=class extends C{constructor(){super(...arguments);o(this,"content");o(this,"leftHalf");o(this,"rightHalf");o(this,"progress_",0)}async onInit(){this.content=document.createElement("div"),this.content.innerHTML=`
<img src="/achive-it/icons/check-small.svg" alt="" width="16" height="16">
<div class="checkbox-container">
    <div style="z-index: 1">
        <div class="checkbox-part clipped">
            <div class="checkbox-circle">
                <div class="circle-half">
                    <div></div>
                </div>
                <div class="circle-half circle-half-right">
                    <div></div>
                </div>
            </div>
        </div>
    </div>
    <div>
        <div class="checkbox-part">
            <div class="checkbox-circle">
                <div class="circle-half">
                    <div></div>
                </div>
                <div class="circle-half circle-half-right">
                    <div></div>
                </div>
            </div>
        </div>
    </div>
    <div class="background-checkbox"></div>
</div>
`,this.append(this.content),this.leftHalf=this.querySelectorAll(".circle-half> div"),this.rightHalf=this.querySelectorAll(".circle-half-right> div"),this.progress=this.progress_}get progress(){return this.progress_}set progress(t){if(t>1&&(t%=1),this.progress_=t,!this.leftHalf||!this.rightHalf)return;let e=180-Math.min(t*2,1)*180;this.leftHalf.forEach(i=>{i.style.transform=`rotate(${Math.round(e)}deg)`});let n=180-Math.max(t*2-1,0)*180;this.rightHalf.forEach(i=>{i.style.transform=`rotate(${Math.round(n)}deg)`}),t===1?this.classList.add("done"):this.classList.remove("done")}};S=J([A({name:"my-checkbox"})],S);var X=Object.defineProperty,Z=Object.getOwnPropertyDescriptor,tt=(r,t,e,n)=>{for(var i=n>1?void 0:n?Z(t,e):t,s=r.length-1,a;s>=0;s--)(a=r[s])&&(i=(n?a(t,e,i):a(i))||i);return n&&i&&X(t,e,i),i};let D=class extends C{};D=tt([A({name:"action-list"})],D);var et=Object.defineProperty,nt=Object.getOwnPropertyDescriptor,it=(r,t,e,n)=>{for(var i=n>1?void 0:n?nt(t,e):t,s=r.length-1,a;s>=0;s--)(a=r[s])&&(i=(n?a(t,e,i):a(i))||i);return n&&i&&et(t,e,i),i};const G=4;let T=class extends C{constructor(t={},e){super();o(this,"input");o(this,"hiddenSpan");o(this,"minWidth",20);o(this,"_value","");o(this,"config",{inputType:"number"});this.observable=e,Object.assign(this.config,t),e&&e.subscribe(n=>{this.value!=n&&(this._value=n,this.value=n)})}async onInit(){this.input=document.createElement("input"),this.input.type=this.config.inputType,this.value=this._value,this.config.min&&(this.input.min=this.config.min),this.config.max&&(this.input.max=this.config.max),this.config.placeholder&&(this.input.placeholder=this.config.placeholder),this.append(this.input),this.hiddenSpan=document.createElement("span"),this.hiddenSpan.classList.add("hidden-span"),this.append(this.hiddenSpan),this.input.addEventListener("keyup",t=>{var e;this.isValidValue(((e=this.input)==null?void 0:e.value)??"")||(t.preventDefault(),this.value=this._value)}),this.input.addEventListener("input",()=>{var t;this.resize(),this.isValidValue(this.value)&&(this._value=this.value,this.observable&&(this.observable.value=((t=this.input)==null?void 0:t.value)??""))}),this.resize()}resize(){if(!this.input||!this.hiddenSpan)return;this.hiddenSpan.innerText=this.input.value;let t=this.hiddenSpan.offsetWidth+G*2;this.hiddenSpan.innerText=this.config.placeholder??"";let e=this.hiddenSpan.offsetWidth+G*2;String(this.value).length!==0&&(e=0),this.input.style.width=Math.max(t,e,this.minWidth)+"px"}get value(){var t;return(t=this.input)==null?void 0:t.value}isValidValue(t){return!(!this.input||this.config.max&&+t>+this.config.max)}set value(t){this.isValidValue(t??"")&&(this._value=t??"",this.input&&(this.input.value=this._value,this.resize()))}set max(t){this.input&&(this.input.max=t)}set min(t){this.input&&(this.input.min=t)}};T=it([A({name:"control-input"})],T);var at=Object.defineProperty,rt=Object.getOwnPropertyDescriptor,st=(r,t,e,n)=>{for(var i=n>1?void 0:n?rt(t,e):t,s=r.length-1,a;s>=0;s--)(a=r[s])&&(i=(n?a(t,e,i):a(i))||i);return n&&i&&at(t,e,i),i};let O=class extends C{constructor(t){super();o(this,"targetTypeSelection");this.isRootTarget=t}async onInit(){const t=document.createElement("img");t.tabIndex=0,t.src="/achive-it/add-left.png",t.alt="Add target one level up",t.title="Add target one level up",t.width=50,t.height=26,this.isRootTarget&&(t.style.visibility="hidden"),t.addEventListener("click",()=>{this.showTargetTypeSelection()}),t.addEventListener("focusout",()=>this.hideTargetTypeSelection());const e=document.createElement("img");e.tabIndex=0,e.src="/achive-it/add-below.png",e.alt="Add target at the same depth",e.title="Add target at the same depth",e.width=50,e.height=26,e.addEventListener("click",()=>{this.showTargetTypeSelection()}),e.addEventListener("focusout",()=>this.hideTargetTypeSelection());const n=document.createElement("img");n.tabIndex=0,n.src="/achive-it/add-right.png",n.alt="Add child target",n.title="Add child target",n.width=50,n.height=26,n.addEventListener("click",()=>{this.showTargetTypeSelection()}),n.addEventListener("focusout",()=>this.hideTargetTypeSelection());let i=document.createElement("div");i.append(t),i.append(e),i.append(n);let s=document.createElement("div");s.classList.add("tts-cont"),this.targetTypeSelection=new K,s.append(this.targetTypeSelection),this.append(s),this.append(i)}showTargetTypeSelection(){this.targetTypeSelection&&(this.targetTypeSelection.style.display="block")}hideTargetTypeSelection(){this.targetTypeSelection&&(this.targetTypeSelection.style.display="none")}};O=st([A({name:"target-button-container"})],O);var lt=Object.defineProperty,ct=Object.getOwnPropertyDescriptor,ot=(r,t,e,n)=>{for(var i=n>1?void 0:n?ct(t,e):t,s=r.length-1,a;s>=0;s--)(a=r[s])&&(i=(n?a(t,e,i):a(i))||i);return n&&i&&lt(t,e,i),i};let _=class extends C{constructor(t){super();o(this,"target_");o(this,"checkbox");o(this,"rowContainer");o(this,"childrenContainer");o(this,"contentContainer");o(this,"titleInput");o(this,"maxAmountEl");o(this,"currentAmountEl");o(this,"$targetAmount");o(this,"$currentAmount");this.target_=t}recalculate(){var t;$(this.target_),this.checkbox&&(this.checkbox.progress=this.target_.calculatedProgress),(t=this.parentTargetElement)==null||t.recalculate(),q()}finishTarget(){switch(this.target_.done=!0,this.target_.calculatedProgress=1,this.checkbox&&(this.checkbox.progress=1),this.target_.targetType){case c.COLLECT_MONEY:case c.REACH_TARGET_1B1:this.target_.extraData.currentAmount=this.target_.extraData.targetAmount,this.$currentAmount.value=this.target_.extraData.currentAmount;break}if(this.recalculate(),!!this.childrenContainer)for(let t=0;t<this.childrenContainer.children.length;t++)this.childrenContainer.children.item(t).finishTarget()}unfinishTarget(){switch(this.target_.done=!1,this.target_.calculatedProgress=0,this.checkbox&&(this.checkbox.progress=0),this.target_.targetType){case c.COLLECT_MONEY:case c.REACH_TARGET_1B1:this.target_.extraData.currentAmount=0,this.$currentAmount.value=this.target_.extraData.currentAmount;break}if(this.recalculate(),!!this.childrenContainer)for(let t=0;t<this.childrenContainer.children.length;t++)this.childrenContainer.children.item(t).unfinishTarget()}async onInit(){this.rowContainer=this.createRowContainer(),this.append(this.rowContainer),this.childrenContainer=this.createChildrenContainer(),this.append(this.childrenContainer)}initCheckbox(){let t=new S;return t.progress=this.target_.calculatedProgress,t.addEventListener("click",()=>{this.target_.done?(this.unfinishTarget(),console.log("unfinish")):(this.finishTarget(),console.log("finish"))}),t}createRowContainer(){const t=document.createElement("div");t.classList.add("row-container");let e=document.createElement("div");e.classList.add("background-element"),t.append(e);let n=document.createElement("div");n.classList.add("good-place-row"),e.append(n);let i=document.createElement("div");i.classList.add("target-header"),n.append(i),this.contentContainer=this.createContentContainer(),n.append(this.contentContainer);let s=document.createElement("div");s.classList.add("target-checkbox"),i.append(s),this.checkbox=this.initCheckbox(),s.append(this.checkbox),this.titleInput=this.createTitleInput(),i.append(this.titleInput),i.append(this.createTargetSpecificInputs());let a=this.createActionList();n.append(a);const u=new O(!1);return n.append(u),t}get parentTargetElement(){var e;let t=(e=this.parentElement)==null?void 0:e.parentElement;return t instanceof _?t:null}createActionList(){let t=new D,e=this;const n=new m("Delete target","delete",()=>{let a=e.parentTargetElement;if(this.outerHTML="",!a){pt(e.target_);return}let u=a.target_;u.children=a.target_.children.filter(g=>g!=this.target_),a.recalculate()});t.append(n);const i=new m("Add date","date",()=>{if(this.target_.date)return;this.target_.date="";let a=new d(this.target_.date);this.contentContainer.append(new L(a))});t.append(i);const s=new m("Add details","add-description",()=>{if(this.target_.details)return;this.target_.details="Write something S.M.A.R.T...";let a=this.createDetails();this.contentContainer.prepend(a)});return t.append(s),t}createContentContainer(){const t=document.createElement("div");if(t.classList.add("target-content"),this.target_.details){let e=this.createDetails();t.append(e)}if(this.target_.date){let e=new d(this.target_.date);t.append(new L(e))}return t}createDetails(){let t=document.createElement("div");t.classList.add("target-details");let e=document.createElement("img");e.src="/achive-it/icons/description-black.svg",t.append(e);let n=document.createElement("span");return n.contentEditable="true",n.innerText=this.target_.details,new MutationObserver(()=>{this.target_.details=n.innerText}).observe(n,{attributes:!1,childList:!0}),t.append(n),t}createChildrenContainer(){const t=document.createElement("div");return t.classList.add("child-list"),this.target_.children.forEach(e=>{let n=new _(e);t.append(n)}),t}createTitleInput(){const t=document.createElement("input");return t.classList.add("title-input"),t.value=this.target_.title,t.placeholder="Target title",t}createTargetSpecificInputs(){let t=document.createElement("div");switch(t.classList.add("target-type-container"),this.target_.targetType){case c.COLLECT_MONEY:this.initCollectMoneyInputs(t);break;case c.REACH_TARGET_1B1:this.initReachTarget1B1Inputs(t);break}return t}initCollectMoneyInputs(t){t.classList.add("control-money");const e=this.$currentAmount=new d(this.target_.extraData.currentAmount,(l,w)=>l>=0&&l<=this.target_.extraData.targetAmount&&l!==w),n=this.$targetAmount=new d(this.target_.extraData.targetAmount,(l,w)=>l!==w);e.subscribe(l=>{this.target_.extraData.currentAmount=l,this.target_.done=l>=this.target_.extraData.targetAmount,this.recalculate()}),n.subscribe(l=>{this.target_.extraData.targetAmount=l,l<e.value&&(e.value=l),this.recalculate()});const i=d.map(e,l=>String(l),l=>Number(l));let s=new m("Add amount","add-amount",()=>{a.value&&(e.value=Math.max(0,Math.min(n.value,Number(+e.value+ +a.value))),a.value="")}),a=new d(""),u=new T({placeholder:"+ Add Amount"},a);this.currentAmountEl=new T({min:"0",max:n.value.toString()},i),n.subscribe(l=>this.currentAmountEl.max=l.toString()),t.append(u),t.append(s),t.append(this.currentAmountEl);let g=document.createElement("span");g.classList.add("target-amount-span"),g.title=`Target amount   
(click to change)`,n.subscribe(l=>{g.innerText=`/ EUR ${l}`}),g.addEventListener("click",()=>{let l=prompt("New target:",n.value.toString());l&&(n.value=Number(l))}),t.append(g)}initReachTarget1B1Inputs(t){t.classList.add("control-1b1-cont");const e=this.$currentAmount=new d(this.target_.extraData.currentAmount,(a,u)=>a>=0&&a<=this.target_.extraData.targetAmount&&a!==u),n=this.$targetAmount=new d(this.target_.extraData.targetAmount,(a,u)=>a>0&&a!==u);e.subscribe(a=>{this.target_.extraData.currentAmount=a,this.target_.done=a>=this.target_.extraData.targetAmount,this.recalculate()}),n.subscribe(a=>{this.target_.extraData.targetAmount=a,a<e.value&&(e.value=a),this.recalculate()});const i=d.map(e,a=>String(a),a=>Number(a));t.append(new m("Decrement current value","minus",()=>e.value--)),t.append(new m("Increment current value","plus",()=>e.value++)),this.currentAmountEl=new T({min:"0",max:n.value.toString()},i),n.subscribe(a=>this.currentAmountEl.max=a.toString()),t.append(this.currentAmountEl);let s=document.createElement("span");s.classList.add("target-amount-span"),s.title=`Target amount   
(click to change)`,n.subscribe(a=>{s.innerText=`/ ${a}`}),s.addEventListener("click",()=>{let a=prompt("New target:",n.value.toString());a&&(n.value=Number(a))}),t.append(s)}set maxAmount(t){if(t!==void 0)switch(this.target_.targetType){case c.REACH_TARGET_1B1:if(!this.maxAmountEl)return;this.maxAmountEl.innerText="/ "+t.toString();break;case c.COLLECT_MONEY:break}}get maxAmount(){return this.target_.extraData.targetAmount}};_=ot([A({name:"my-target"})],_);const f=document.querySelector(".app-layout");let dt=new V({name:"My Goals",url:"/achive-it/dashboard.html"});f.appendChild(dt);const E=document.createElement("input");E.classList.add("goal-title");E.value="Become a better person";E.placeholder="Goal title";f.appendChild(E);let v=new U;v.style.marginBottom="10px";f.appendChild(v);const b=document.createElement("div");b.classList.add("goal-buttons");f.append(b);const k=document.createElement("div");b.append(k);const ht=new d("2023-12-23");let j=new L(ht);j.style.gap="3px";k.append(j);const ut=new m("Add details","add-description",()=>{alert("Add details field to goal. To be implemented with the backend support. Currently we just display the details fields if they are already added to the goal.")});k.append(ut);let I=document.createElement("div");b.appendChild(I);let M=new P("/achive-it/icons/tick-circle.svg","MARK COMPLETED");M.classList.add("icon-button-green");I.appendChild(M);let B=new P("/achive-it/icons/very-dissatisfied-circle.svg","CANCEL GOAL");B.classList.add("icon-button-red");I.appendChild(B);let h=[{title:"Cut the grass",children:[],done:!1,targetType:c.TASK},{title:"Chop up the potatoes",children:[],done:!1,targetType:c.REACH_TARGET_1B1,extraData:{targetAmount:10,currentAmount:3}},{title:"Save money to pay the bills",children:[],done:!1,targetType:c.COLLECT_MONEY,extraData:{targetAmount:110,currentAmount:95}},{title:"Do the dishes",done:!1,targetType:c.TASK,children:[{title:"Put the dry dishes in the cabinet",done:!1,targetType:c.TASK,children:[]},{title:"Put the dirty dishes in the dishwasher except the knifes",done:!0,children:[],targetType:c.TASK},{title:"Start the dishwasher",done:!1,children:[],targetType:c.TASK,date:"2023-12-23"},{title:"Chop up the potatoes",children:[],done:!1,targetType:c.REACH_TARGET_1B1,extraData:{targetAmount:8,currentAmount:6}},{title:"Wash the remanining dishes by hand",done:!1,children:[{title:"Clean the toilet",done:!1,children:[],targetType:c.TASK},{title:"Clean the sink",done:!0,children:[],targetType:c.TASK}],targetType:c.TASK,date:"2023-12-23",details:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Quisque vehicula quam at purus congue, ut pretium felis mattis. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Donec in magna aliquam, sagittis ex eget, laoreet neque. Donec volutpat elit sagittis ligula faucibus, et luctus augue interdum."}]},{title:"Clean the bathroom",done:!0,targetType:c.TASK,children:[{title:"Clean the toilet",done:!0,children:[],targetType:c.TASK},{title:"Clean the sink",done:!0,children:[],targetType:c.TASK}]}];function q(){let r=0;if(h.length==0){v.setAttribute("rate","0");return}h.forEach(t=>{r+=t.calculatedProgress}),r/=h.length,v.setAttribute("rate",r.toString())}function pt(r){h=h.filter(t=>t!==r),q()}let y=document.createElement("div");y.classList.add("target-list");B.addEventListener("click",()=>{y.innerHTML="",h=new Array,v.setAttribute("rate","0")});let x=0;h.forEach(r=>{x+=$(r)});h.length>0&&(x/=h.length);console.log(x);v.setAttribute("rate",x.toString());const W=new Array;for(let r of h){let t=new _(r);y.append(t),W.push(t)}M.addEventListener("click",()=>{W.forEach(r=>{r.finishTarget()})});f.appendChild(y);const p=document.createElement("div");p.style.display="flex";p.style.justifyContent="center";p.style.marginTop="20px";f.appendChild(p);let R=document.createElement("div");R.classList.add("tts-cont");let H=new K;H.style.display="none";R.append(H);p.append(R);const N=new P("/achive-it/icons/plus.svg","Add Target");N.classList.add("add-target-btn");N.addEventListener("click",()=>{H.style.display="block"});p.addEventListener("focusout",()=>p.style.display="none");p.appendChild(N);
